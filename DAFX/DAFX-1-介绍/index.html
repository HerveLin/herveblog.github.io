<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.8.0">

    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->

    

    
        <meta name="description" content="MathJax.Hub.Config({tex2jax: {inlineMath: [[&#39;$&#39;,&#39;$&#39;], [&#39;\\(&#39;,&#39;\\)&#39;]]}});


1 介绍&amp;emsp;1.1 基于MATLB的数字音频效果-DAFX&amp;emsp;1.2 数字信号处理的基础&amp;emsp;&amp;emsp;1.2.1 数字信号&amp;">
    

    <!--Author-->
    
        <meta name="author" content="Herve Lin">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="DAFX-介绍">
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="MathJax.Hub.Config({tex2jax: {inlineMath: [[&#39;$&#39;,&#39;$&#39;], [&#39;\\(&#39;,&#39;\\)&#39;]]}});


1 介绍&amp;emsp;1.1 基于MATLB的数字音频效果-DAFX&amp;emsp;1.2 数字信号处理的基础&amp;emsp;&amp;emsp;1.2.1 数字信号&amp;">
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="Herve&#39;s blog">

    <!--Type page-->
    
        <meta property="og:type" content="article">
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="http://yoursite.com/img/home-bg.jpg">
    

        <meta name="twitter:card" content="summary_large_image">

    

    
        <meta name="twitter:image" content="http://yoursite.com/img/home-bg.jpg">
    

    <!-- Title -->
    
    <title>DAFX-介绍 - Herve&#39;s blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet">

    <!-- Google Analytics -->
    


    <!-- favicon --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    

</head>


<body>

    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">MENU</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                Categories
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/klugjo/hexo-theme-clean-blog">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>DAFX-介绍</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        
                            2019-03-30
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/DAFX-Chinese/">#DAFX Chinese</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
<script type="text/javascript" async src="https://cdn.staticfile.org/MathJax/MathJax-2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>

<p>1 介绍<br>&emsp;1.1 <a href="#1.1">基于MATLB的数字音频效果-DAFX</a><br>&emsp;1.2 <a href="#1.2">数字信号处理的基础</a><br>&emsp;&emsp;1.2.1 <a href="#1.2.1">数字信号</a><br>&emsp;&emsp;1.2.2 <a href="#1.2.2">数字信号的频谱分析</a><br>&emsp;&emsp;1.2.3 <a href="#1.2.3">数字系统</a><br>&emsp;1.3 结论<br>&emsp;参考书目</p>
<p><span id="1.1"></span></p>
<h2 id="1-1-基于MATLAB的数字音效DAFX"><a href="#1-1-基于MATLAB的数字音效DAFX" class="headerlink" title="1.1 基于MATLAB的数字音效DAFX"></a>1.1 基于MATLAB的数字音效DAFX</h2><p>&emsp;&emsp;音效处理广泛被应用到声音信号发生，以及包括音乐家用于使用特殊的演奏技术，用于融合了特殊的技术的麦克风收音技术，和用于将音效处理用于生成，录制，制作和发布声音信号。这本书将包含一些对声音或音频效果与它们的传播影响的修改方法。数字音效处理（DAFX）是像是一个软件工具盒子或者说黑匣子，以声音或音频信号作为输出，根据一些声音控制参数进行修改后，把输出信号或声音传递出去（图1.1）.输入和输出信号由扬声器或耳机和某些具象关联信号例如时间信号、信号强度水平或频谱所监控。根据声学标准，那些声音工程师或音乐家设置他们控制参数以达到他们想要的效果。输入和输出信号都以数字格式存在以及以模拟音频信号呈现。输入信号中声音特性的修改是数字音效的主要目的。控制参数的设置通常由声音工程师，音乐家或简单的由听者进行调制，同时设置的机制也可以内嵌到数字音效当中。<br>&emsp;&emsp;本书的目的是描述关于以下的数字音效：</p>
<ul>
<li>物理和声学效果：我们简述物理背景和物理解释。阐述物理方法和生成音效的设备。</li>
<li>数字音效处理：我们对基础算法给出正式的描述和展示一些实现的例子。</li>
<li>音乐的应用：我们指出一些音乐的应用和在CD或网络上给出声音例子的参考。</li>
</ul>
<p>&emsp;&emsp;在每个效果描述前会先介绍数字音效的物理和声学现象，还会给出一个用于音乐应用的信号处理技术和效果参数控制的解释。<br>在这个解释的章节，我们接下来会解释一些简单的基础数字信号处理。在MATLAB或其他免费的仿真上展示怎么去写音效处理的仿真程序。MATLAB的数字音效处理的实现可以在电脑上实时运行，更强大的是可以实时控制他们的参数。虽然它非常的强大，但是信号处理的编程和特定的音效算法可以在MATLAB上容易的进行，也容易学习上手。</p>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.1.JPG" alt="图1.1"><br><em>图1.1 数字音效和它的控制【Arf99】</em></div>

<p></p>
<p><span id="1.2"></span></p>
<h2 id="1-2-数字信号处理的基础"><a href="#1-2-数字信号处理的基础" class="headerlink" title="1.2 数字信号处理的基础"></a>1.2 数字信号处理的基础</h2><p>&emsp;&emsp;数字信号处理的基础包括了数字信号（在本书是数字音频信号）的原理和数字系统的原理。数学信号是具有适当数值表示的数字序列。数字系统利用软件算法，根据输入的数字序列来计算输出的数字序列。数字系统的视觉表示利用功能性的对话框或者信号浮动图示。我们将重点地介绍一些简单的基础知识作为开篇的注释，并给读者文献参考，以介绍数字信号处理。 </p>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.2.JPG" alt="图1.2"><br><em>图1.2 ADC进行采样与量化，数字音效处理和DAC重建音频信号</em></div>

<p></p>
<p><span id="1.2.1"></span></p>
<h2 id="1-2-1-数字信号处理的基础"><a href="#1-2-1-数字信号处理的基础" class="headerlink" title="1.2.1 数字信号处理的基础"></a>1.2.1 数字信号处理的基础</h2><p>&emsp;&emsp;数字信号通过模拟数字转换器ADC将模拟的信号转为一个数字序列。ADC对在一个等距水平时间轴网格上的模拟信号x(t)的幅度进行采样，并量化幅度数值得到固定在垂直网格上的数字集x(n)。（图1.2）.这些采样点显示为以带一个顶点的垂直线。模拟信号x(t)在连续的时间t上（单位usec）表示信号幅度。回到ADC，数字（离散的时间和量化的幅度）信号由采样x(n)序列（流），以数字在离散的指数n上表示。两 个连续的采样时间距离称为采样间隔T（采样周期），它的倒数是采样频率fs=1/T（采样率）。采样频率反映了每秒内的采样数量，单位是赫兹（Hz）。根据采样定理，要完全采样模拟信号，必须以它的的最高频率fmax（信号带宽）的两倍以上进行采样，也就是fs&gt;2•fmax。如果我们强制使用一个固定的采样频率fs，我们就得确保我们采样的输入频率的带宽符合fmax=fs/2。否则，我们就需要一个低通滤波器把fmax以外的频率滤除。接着数字信号进入DAFX盒（数字系统），对每个采样简单的乘以0.5并传递为输出信号：y(n)=0.5•x(n)。紧接着信号y(n)往前j纳入数字模拟转换器DAC，重建模拟信号y(t)。输出信号y(t)的幅值是输入信号x(t)的一般。下面的M-file 1.1是图1.2的一个例子。</p>
<h4 id="M-file-1-1-figure1-02-m"><a href="#M-file-1-1-figure1-02-m" class="headerlink" title="M-file 1.1 (figure1_02.m)"></a>M-file 1.1 (figure1_02.m)</h4><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">subplot(<span class="number">2</span>,<span class="number">4</span>,<span class="number">1</span>);</span><br><span class="line"><span class="built_in">plot</span>((<span class="number">0</span>:<span class="number">96</span>) *<span class="number">5</span>,y(<span class="built_in">i</span>:<span class="number">97</span>));</span><br><span class="line">title(<span class="string">'x(t)'</span>);</span><br><span class="line">axis([O <span class="number">500</span> <span class="number">-0.05</span> <span class="number">0.05</span>]);</span><br><span class="line">xlabel(<span class="string">'t in \musec \rightarrow'</span>);</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">4</span>,<span class="number">2</span>);</span><br><span class="line">stem((<span class="number">0</span>:<span class="number">24</span>),u1(<span class="number">1</span>:<span class="number">25</span>),<span class="string">'.'</span>);axis([O <span class="number">25</span> <span class="number">-0.05</span> <span class="number">0.05</span>]); xlabel(<span class="string">'n \rightarrow'</span>);</span><br><span class="line">title(<span class="string">'x(n)'</span>);</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>);</span><br><span class="line">stem((<span class="number">0</span>:<span class="number">24</span>),<span class="number">0.5</span>*u1(<span class="number">1</span>:<span class="number">25</span>),<span class="string">'.'</span>);axis([O <span class="number">25</span> <span class="number">-0.05</span> <span class="number">0.05</span>]); xlabel (<span class="string">'n \right arrow'</span>) ;</span><br><span class="line">title(<span class="string">'y(n)'</span>);</span><br><span class="line">subplot(<span class="number">2</span>,<span class="number">4</span>,<span class="number">4</span>);</span><br><span class="line"><span class="built_in">plot</span>((<span class="number">0</span>:<span class="number">96</span>)*<span class="number">5</span>,<span class="number">0.5</span>*y(<span class="number">1</span>:<span class="number">97</span>)) ;axis([O <span class="number">500</span> <span class="number">-0.05</span> <span class="number">0.05</span>]); xlabel(<span class="string">'t in \mu sec \rightarrow'</span>);</span><br><span class="line">title(<span class="string">'y(t)'</span>);</span><br></pre></td></tr></table></figure>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.3.JPG" alt="图1.3"><br><em>图1.3 不同时间段的数字音频信号</em></div>

<p>&emsp;&emsp;图1.3展示了一些数字信号的图像（看M-file 1.2）。最上面的部分是8000个采样，中间部分是前1000个采样，下面是前100个采样。只有样本数足够少，才会用线点图显示数字信号。</p>
<h4 id="M-file-1-2-figure1-03-m"><a href="#M-file-1-2-figure1-03-m" class="headerlink" title="M-file 1.2 (figure1_03.m)"></a>M-file 1.2 (figure1_03.m)</h4><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[ul,FS,NBITS]=wavread(<span class="string">'ton2. wav'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(!) </span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>); </span><br><span class="line"><span class="built_in">plot</span> (<span class="number">0</span>: <span class="number">7999</span>, ul (<span class="number">1</span>: <span class="number">8000</span>)) ;ylabel (<span class="string">'x(n)'</span>); </span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>); </span><br><span class="line"><span class="built_in">plot</span> (<span class="number">0</span>:<span class="number">999</span>, ul (<span class="number">1</span>: <span class="number">1000</span>)) ;ylabel(<span class="string">'x(n)'</span>); </span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">3</span>); </span><br><span class="line">stem(<span class="number">0</span>:<span class="number">99</span>,ui(l:<span class="number">100</span>),<span class="string">'.'</span>);ylabel(<span class="string">'x(n)'</span>); </span><br><span class="line">xlabel(<span class="string">'n \rightarrow'</span>);</span><br></pre></td></tr></table></figure>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.4.JPG" alt="图1.4"><br><em>图1.4 数字音频信号的垂直与水平尺度格式</em></div>

<p>&emsp;&emsp;图1.4展示了数字音频信号两个不同的垂直尺度格式。幅度量化的的量程固定在-32768到32767，这是由16位宽的ADC决定的，216可以表示范围-215到215-1。通常w位宽的数字范围是-2w-1到2w-1。如果我们把所有的整数值除于最大的绝对值，例如32768，我们会得到图1.4中垂直的归一化尺度，范围是-1到1-Q。Q是量化步长，可以由式子Q=2-(w-1)计算，当w=16，Q=3.0158e-005。图1.4也展示了水平尺度格式，一般常见的分别是连续时间轴，离散时间轴和归一化离散时间轴。在这样的狭窄描述下，我们可以定义采样一个模拟信号和量化幅度为固定值的数字信号为离散时间和离散幅度信号。数学信号又一系列数值x(n)表示。模拟信号通过DAC重建。更多关于ADC和DAC以他们的相关理论可以在各种文献找到。上面的简短介绍对于我们的讨论已经足够。</p>
<p>&emsp;&emsp;信号处理算法通常以块处理（block processing）或抽样处理（sample-by-sample）的方式处理信号。相关数字音效的例子在文献【Arf98】可以找到。对于块处理，数据被挪到缓存中，接着每次处理，缓存会被新的数据填满。像是频谱计算的快速傅里叶变换（FFTs）和快速卷积的例子中，每个输入样本的处理是基于抽样处理。<br>这个通过常数a给声音x(n)（图1.2）加权的基础算法（M-file 1.3）描述了一个抽样处理过程。输入信号又一个向量x(0)，x(1)，••••••，x(length(x)-1)表示。</p>
<h4 id="M-file-1-3-sbs-alg-m"><a href="#M-file-1-3-sbs-alg-m" class="headerlink" title="M-file 1.3 (sbs_alg.m)"></a>M-file 1.3 (sbs_alg.m)</h4><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% Read input sound file into vector x(n) and sampling frequency FS</span></span><br><span class="line">[x,FS]=wavread(<span class="string">'input filename'</span>);</span><br><span class="line"><span class="comment">% Sample-by sample algorithm y(n)=a*x(n)</span></span><br><span class="line"><span class="keyword">for</span> n=<span class="number">1</span>:<span class="built_in">length</span>(x),</span><br><span class="line">y(n)=a * x(n); </span><br><span class="line"><span class="keyword">end</span>; </span><br><span class="line"><span class="comment">% Write y(n) into output sound file with number of </span></span><br><span class="line"><span class="comment">% bits Nbits and sampling frequency FS </span></span><br><span class="line">wavwrite(y,FS,Nbits,<span class="string">'output filename'</span>);</span><br></pre></td></tr></table></figure>
<p></p>
<p><span id="1.2.2"></span></p>
<h2 id="1-2-2-数字信号的频谱分析"><a href="#1-2-2-数字信号的频谱分析" class="headerlink" title="1.2.2 数字信号的频谱分析"></a>1.2.2 数字信号的频谱分析</h2><p>&emsp;&emsp;一个信号的频谱表示了在频域范围内，这个信号的能量分布。图1.5的上半部分展示了模拟音频信号的短时频谱。信号频率的上限是20kHz。对应的数字信号是通过采样与量化fs=40kHz的模拟信号的得到的。相对应的短时数字信号频谱在图1.5的下半部分展示。采样操作决定了得到什么样的模拟信号基带频谱【Orf96】。在数学信号的频谱中，模拟信号的0Hz到20Hz这时也包含在了40kHz到60kHz的范围，它的折叠版本（镜像）出现在40kHz到20kHz。在40kHz的基带频谱的第一个图像也会出现在fs=40kHz的整数倍数的频率处。但是请注意数字信号的0kHz到20kHz的频谱是准确对应模拟信号的。通过简单的给数字信号进行低通滤波，滤掉高于fs/2=20kHz的频率，从而利用数字信号重建模拟信号。在图1.5下方的数字信号频谱中，我们把高于20kHz的频谱给去掉，会得到上面的模拟信号频谱。</p>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.5.JPG" alt="图1.5"><br><em>图1.5 模拟信号与数字信号的频谱</em></div>

<h3 id="离散傅里叶变换"><a href="#离散傅里叶变换" class="headerlink" title="离散傅里叶变换"></a>离散傅里叶变换</h3><p>&emsp;&emsp;数字信号的频谱可以通过离散傅里叶变换（DFT）来计算，我们给到式子：</p>

$$
X(k)=DFT[x(n)]=\sum_{n=0}^{N-1}x(n){e^{-j2\pi nk/N}}(k=0,1,...,N-1)
\tag{1.1}
$$

<p>&emsp;&emsp;上面的式子有个快速计算的版本叫快速傅里叶变换（FFT）。FFT会在信号x(n)中取N个连续的样本，通过数学计算产生N个采样X(k)的信号频谱。图1.6是对一个16采样数的余弦信号进行16个点的FFT的结果。通过<code>X=abs(fft(x,N))/N</code>对结果进行N的归一化。</p>
<p>&emsp;&emsp;N个采样X(k)=X<sub>R</sub>(k)+jX<sub>I</sub>(k)是由实部X<sub>R</sub>(k)和虚部X<sub>I</sub>(k)组成的复数，同时我们可以通过以下式子计算它的绝对值，也就可以得到幅频谱：</p>

$$
\lvert X(k) \rvert = \sqrt{{X_R}^2(k)+{X_I}^2(k)}(k=0,1,...,N-1)
\tag{1.2}
$$

<p>&emsp;&emsp;同时通过以下式子计算相位，也就可以得到相频谱：</p>

$$
\varphi(k) = \arctan{\frac{{X_I}(k)}{{X_R}(k)}} (k=0,1,...,N-1)
\tag{1.3}
$$

<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.6.JPG" alt="图1.6 FFT算法的频谱分析"><br><em>图1.6 FFT算法的频谱分析：(a) N=16个采样的数字余弦函数，(b)N=16个频率采样的幅频分析|X(k)|和(c)从0Hz到采样频率fs=40000Hz的幅频分析|X(f)|</em> </div>

<p>&emsp;&emsp;图1.6是从0Hz到$\frac{N-1}{N}f_s$，步长为$\frac{f_s}{N}$，通过FFT得到的N个平均频率点的信号频谱。这些信号点的排列通过$k\frac{f_s}{N}$得到，k的取值为0,1,2,…,N-1。幅频$\lvert X(f) \rvert$通常以对数的幅度尺度描绘，尺度换算关系是$20\log_{10}\frac{X(f)}{0.5}$，最大振幅为±1的正弦曲线为0dB。图1.7是图1.6例子的采样频率fs与它的整数倍的基频谱。我们可以在第一张图看到原来的频率5kHz在对折的地方$f_s-f_{cosine}=(40000-5000)Hz=35000Hz$也出现了。下面的M-file 1.4 是图1.6和图1.7的计算程序。</p>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.7.JPG" alt="图1.7"><br><em>图1.7 对数dB下从0Hz到采样频率fs=40000Hz下的幅频|X(f)|</em> </div>

<h4 id="M-file-1-4（figure1-06-07-m）"><a href="#M-file-1-4（figure1-06-07-m）" class="headerlink" title="M-file 1.4（figure1_06_07.m）"></a>M-file 1.4（figure1_06_07.m）</h4><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">N=<span class="number">16</span></span><br><span class="line">x=<span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*<span class="number">2</span>*(<span class="number">0</span>:<span class="number">1</span>:N<span class="number">-1</span>)/N)’;</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(!) </span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>);stem(<span class="number">0</span>:N<span class="number">-1</span>,x,<span class="string">'.'</span>); </span><br><span class="line">axis((<span class="number">-0.2</span> N <span class="number">-1.2</span> <span class="number">1.2</span>]); </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">'Cosine signal x(n)'</span>); </span><br><span class="line">ylabel(<span class="string">'a)'</span>); </span><br><span class="line">xlabel (<span class="string">'n \rightarrow'</span>) ; </span><br><span class="line">X==<span class="built_in">abs</span>(fft(x,N))/N; </span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>) ;stem(<span class="number">0</span>:N<span class="number">-1</span>,X,<span class="string">'.'</span>); </span><br><span class="line">axis ([ <span class="number">-0.</span> <span class="number">2</span> N <span class="number">-0.</span> <span class="number">1</span> <span class="number">1.</span> <span class="number">1</span>]) ; </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">'Magnitude spectrum\index&#123;Magnitude spectrum&#125; IX(k) I'</span>); </span><br><span class="line">ylabel(<span class="string">'b)'</span>); </span><br><span class="line">xlabel (<span class="string">'k \rightarrow'</span>)</span><br><span class="line"></span><br><span class="line">N=<span class="number">1024</span>;</span><br><span class="line">x=<span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*(<span class="number">2</span>*<span class="number">1024</span>/<span class="number">16</span>)*(<span class="number">0</span>:<span class="number">1</span>:N<span class="number">-1</span>)/N)’;</span><br><span class="line"></span><br><span class="line">FS=<span class="number">40000</span>;</span><br><span class="line">F=( (<span class="number">0</span>:N<span class="number">-1</span>)/N)*FS;</span><br><span class="line">X=<span class="built_in">abs</span>(fft(x,N))/N; </span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">3</span>);<span class="built_in">plot</span>(f,X); </span><br><span class="line">axis([<span class="number">-0.2</span>*<span class="number">44100</span>/<span class="number">16</span> <span class="built_in">max</span>(f) <span class="number">-0.1</span> <span class="number">1.</span> <span class="number">1</span>]); </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">'Magnitude spectrum\index&#123;Magnitude spectrum&#125; IX(f)I'</span>); </span><br><span class="line">ylabel(<span class="string">'c)'</span>); </span><br><span class="line">xlabel(<span class="string">'f in Hz \rightarrow'</span>) </span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>) </span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>);<span class="built_in">plot</span>(f,<span class="number">20</span>*<span class="built_in">log10</span>(X./(<span class="number">0.5</span>))); </span><br><span class="line">axis([<span class="number">-0.2</span>*<span class="number">44100</span>/<span class="number">16</span> <span class="built_in">max</span>(f) <span class="number">-45</span> <span class="number">20</span>]); </span><br><span class="line"><span class="built_in">legend</span>(<span class="string">'Magnitude spectrum\index&#123;Magnitude spectrum&#125; IX(f)I in dB'</span>);</span><br><span class="line">ylabel(<span class="string">'IX(f)I in dB \rightarrow'</span>); </span><br><span class="line">xlabel(<span class="string">'f in Hz \rightarrow’）</span></span><br></pre></td></tr></table></figure>
<h3 id="离散傅里叶逆变换（IDFT）"><a href="#离散傅里叶逆变换（IDFT）" class="headerlink" title="离散傅里叶逆变换（IDFT）"></a>离散傅里叶逆变换（IDFT）</h3><p>&emsp;&emsp;同时DFT被用于离散时域的离散频域分析，而离散傅里叶逆变换IDFT可以让变换转而从离散频域到离散时域。IDFT的算法由式子给到：</p>

$$
X(n)=IDFT[x(k)]=\frac{1}{N}\sum_{k=0}^{N-1}X(k){e^{j2\pi nk/N}}(n=0,1,...,N-1)
\tag{1.4}
$$

<p>&emsp;&emsp;IDFT的快速版本称为快速傅里叶逆变换。取频域中N个复数和量X(k)=X*(N-k)，接着用IFFT得到N个离散时间采样实数x(n)。</p>
<h3 id="频率分辨率：填充零与窗函数"><a href="#频率分辨率：填充零与窗函数" class="headerlink" title="频率分辨率：填充零与窗函数"></a>频率分辨率：填充零与窗函数</h3><p>&emsp;&emsp;为了提高频谱分析的频率分辨率，简单的可以给FFT算法提高采样数。典型的FFT分辨率是N=256,512,1024,2048,4096和8192。在64个采样的频谱计算上，想要提高分辨率到f<sub>s</sub>/64到f<sub>s</sub>/1024，我们需要通过插入零采样拓展64个音频采样序列到1024的长度以计算1024点的FFT。M-file 1.5和图1.8有提到这个称作填充零（Zero-padding）的方法。图1.8的左上部分是原始的8个采样序列，右上部分是相应的8点FFT结果。左下部分是给原始的8个采样序列插入8个零采样扩展为长度N=16的序列。左下部分是对长度为N=16的填充零后的序列进行16点的FFT得到的幅频|X(k)|。注意8点和16点FFT之间频率分辨率的提升。在上面的频谱中每个频率块（bin）之间，有新的频率块被进行运算，得到下面的频谱。16点FFT中的这些块k=0,2,4,6,8,10,12,14是相对于8点FFT的这些块k=0,1,2,3,4,5,6,7。这些N个频率块包含了频率从0Hz到$\frac{N-1}{N}f_{s}Hz$。</p>
<h4 id="M-file-1-5（figure1-08-m）"><a href="#M-file-1-5（figure1-08-m）" class="headerlink" title="M-file 1.5（figure1_08.m）"></a>M-file 1.5（figure1_08.m）</h4><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">x1=[<span class="number">-1</span> <span class="number">-0.5</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">1</span> <span class="number">0.5</span> <span class="number">-1</span>];</span><br><span class="line">x2(<span class="number">16</span>)=<span class="number">0</span>;</span><br><span class="line">x2(<span class="number">1</span>:<span class="number">8</span>)=x1;</span><br><span class="line"></span><br><span class="line">subplot (<span class="number">221</span>); </span><br><span class="line">stem(<span class="number">0</span>:<span class="number">1</span>:<span class="number">7</span>,x1);axis([<span class="number">-0.5</span> <span class="number">7.5</span> <span class="number">-1.5</span> <span class="number">2.5</span>]);• </span><br><span class="line">ylabel (<span class="string">'x (n) \rightarrow'</span>) ; title (<span class="string">'8 samples'</span>) ; </span><br><span class="line">subplot(<span class="number">222</span>); </span><br><span class="line">stem(<span class="number">0</span>:<span class="number">1</span>:<span class="number">7</span>,<span class="built_in">abs</span>(fft(xi)));axis([<span class="number">-0.5</span> <span class="number">7.5</span> <span class="number">-0.5</span> <span class="number">10</span>]); </span><br><span class="line">ylabel (<span class="string">'IX (k) I \rightarrow）；title('</span><span class="number">8</span>-point FFT');</span><br><span class="line"></span><br><span class="line">subplot(<span class="number">223</span>); </span><br><span class="line">stem(<span class="number">0</span>:<span class="number">1</span>:<span class="number">15</span>,x2);axis([<span class="number">-0.5</span> <span class="number">15.5</span> <span class="number">-1.5</span> <span class="number">2</span> <span class="number">.5</span>]); </span><br><span class="line">xlabel(<span class="string">'n \rightarrow'</span>);ylabel(<span class="string">'x(n) \rightarrow'</span>); </span><br><span class="line">title(<span class="string">'8 samples + zero-padding'</span>); </span><br><span class="line"></span><br><span class="line">subplot(<span class="number">224</span>); </span><br><span class="line">stem(<span class="number">0</span>:<span class="number">1</span>:<span class="number">15</span>,<span class="built_in">abs</span>(fft(x2)));axis([<span class="number">-1</span> <span class="number">16</span> <span class="number">-0.5</span> <span class="number">10</span>]); </span><br><span class="line">xlabel(<span class="string">'k \rightarrow'</span>);ylabel(<span class="string">'IX(k)I\rightarrow'</span>); </span><br><span class="line">title(<span class="string">'16-point FFT'</span>);</span><br></pre></td></tr></table></figure>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.8.JPG" alt="图1.8"><br><em>图1.8 用填充零的方式提高频率分辨率</em> </div>

<p>&emsp;&emsp;频率泄露的效应发生时因为从信号中截出了N个采样。图1.9展示了频率泄露的效应，相应的M-file 1.6在下方可以找到。在围绕着主频率，余弦的频率有涂抹（噪化）的现象。我们可以通过选择像Blackman窗或者汉宁（Hamming）窗等窗函数并用窗函数给N个音频采样进行加权来减小频率泄露的效应。加权是根据式子x<sub>w</sub>=w(n)∙x(n)，其中0≤n≤N-1，接着对加权后的信号进行FFT。图1.9中间部分是加权后的余弦函数和它的FFT频谱分析。图1.10还展示了一个简单的减小频率泄露的例子，可以通过M-file 1.7得到这个图的结果。</p>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.9.JPG" alt="图1.9"><br><em>图1.9 数字信号的频谱分析：取N个采样并进行N点的离散傅里叶变换，产生N个样本的信号频谱，范围从0Hz到$k\frac{f_{s}}{N}Hz$，k=0,1,2,…,N-1。（a）$x(n) = \cos(2\pi \frac{1kHz}{44.1kHz}n)$</em> </div>

<p>&emsp;&emsp;窗口函数：</p>

$$
w_{B}(n) = 0.42 - 0.5\cos(2\pi n/N) + 0.08\cos(4\pi n/N), 
\tag{1.5}
$$
$$
w_{H}(n) = 0.54 - 0.46\cos(2\pi n/N), 
\tag{1.6}
$$
$$
n=0,1,…N-1.
$$

<h4 id="M-file-1-6（figure1-09-m）"><a href="#M-file-1-6（figure1-09-m）" class="headerlink" title="M-file 1.6（figure1_09.m）"></a>M-file 1.6（figure1_09.m）</h4><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">x=<span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*<span class="number">1000</span>*(<span class="number">0</span>:<span class="number">1</span>:N<span class="number">-1</span>)/<span class="number">44100</span>)';</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">W=black.man(N);</span><br><span class="line">W=N*W/sum(W); <span class="comment">%scaling of window </span></span><br><span class="line">f=((<span class="number">0</span>:N/<span class="number">2</span><span class="number">-1</span>)/N)*FS; </span><br><span class="line"></span><br><span class="line">xw=x.*W; </span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>);<span class="built_in">plot</span>(<span class="number">0</span>:N<span class="number">-1</span>,x); </span><br><span class="line">axis([<span class="number">0</span> <span class="number">1000</span> <span class="number">-1.1</span> <span class="number">1.</span> <span class="number">1</span>]); </span><br><span class="line">title(<span class="string">'a) Cosine signal x(n)'</span>) </span><br><span class="line"></span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>);<span class="built_in">plot</span>(<span class="number">0</span>:N<span class="number">-1</span>,xw);axis([<span class="number">0</span> <span class="number">8000</span> <span class="number">-4</span> <span class="number">4</span>]); </span><br><span class="line">title(<span class="string">'c) Cosine signal x_w(n)=x(n) \cdot w(n) with window'</span>)</span><br><span class="line"></span><br><span class="line">X= <span class="number">20</span>*<span class="built_in">log10</span>(<span class="built_in">abs</span>(fft(x,N))/(N/<span class="number">2</span>));</span><br><span class="line">subplot (<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>) ;<span class="built_in">plot</span>(f ,X(<span class="number">1</span>:N/<span class="number">2</span>)); </span><br><span class="line">axis([<span class="number">0</span> <span class="number">10000</span> <span class="number">-80</span> <span class="number">10</span>]); </span><br><span class="line">ylabel(<span class="string">'X(f)'</span>); </span><br><span class="line">title(<span class="string">'b) Spectrum of cosine signal'</span>) </span><br><span class="line"></span><br><span class="line">Xw=<span class="number">20</span>*<span class="built_in">log10</span>(<span class="built_in">abs</span>(fft(xw,N))/(N/<span class="number">2</span>)); </span><br><span class="line">subplot (<span class="number">3</span>, <span class="number">2</span> ,<span class="number">4</span>) ;<span class="built_in">plot</span>(f ,Xw(l: N/<span class="number">2</span>)); </span><br><span class="line">axis([<span class="number">0</span> <span class="number">10000</span> <span class="number">-80</span> <span class="number">10</span>]); </span><br><span class="line">ylabel(<span class="string">'X(f)'</span>); </span><br><span class="line">title(<span class="string">'d) Spectrm with Blackman window'</span>) </span><br><span class="line"></span><br><span class="line">s=u1(<span class="number">1</span>:N).*W; </span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">2</span>,<span class="number">5</span>);<span class="built_in">plot</span>(<span class="number">0</span>:N<span class="number">-1</span>,s);axis([<span class="number">0</span> <span class="number">8000</span> <span class="number">-1.1</span> <span class="number">1.1</span>]);</span><br><span class="line">xlabel (<span class="string">'n \rightarrow'</span>) ; </span><br><span class="line">title(<span class="string">'e) Audio signal x_w(n) with window'</span>)</span><br><span class="line"> </span><br><span class="line">Sw=<span class="number">20</span>*<span class="number">1</span>og10(<span class="built_in">abs</span>(fft(s,N))/(N/<span class="number">2</span>)); </span><br><span class="line">subplot(<span class="number">3</span>,<span class="number">2</span>,<span class="number">6</span>);<span class="built_in">plot</span>(f,Sw(<span class="number">1</span>:N/<span class="number">2</span>)); </span><br><span class="line">axis([<span class="number">0</span> <span class="number">10000</span> <span class="number">-80</span> <span class="number">10</span>]); </span><br><span class="line">ylabel(<span class="string">'X(f)'</span>); </span><br><span class="line">title(<span class="string">'f) Spectrum with Blackman window'</span>) </span><br><span class="line">xlabel(<span class="string">'f in Hz \rightarrow’);</span></span><br></pre></td></tr></table></figure>
<h4 id="M-file-1-7（figure1-10-m）"><a href="#M-file-1-7（figure1-10-m）" class="headerlink" title="M-file 1.7（figure1_10.m）"></a>M-file 1.7（figure1_10.m）</h4><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">x=[<span class="number">-1</span> <span class="number">-0.5</span> <span class="number">1</span> <span class="number">2210.5</span><span class="number">-1</span>];</span><br><span class="line">w=w*<span class="number">8</span>/sum(w);</span><br><span class="line">x1=x.*w’;</span><br><span class="line">x2(<span class="number">16</span>)=<span class="number">0</span>; </span><br><span class="line">x2(<span class="number">1</span>:<span class="number">8</span>)=x1; </span><br><span class="line"></span><br><span class="line">subplot(<span class="number">421</span>); </span><br><span class="line">stem(<span class="number">0</span>:<span class="number">1</span>:<span class="number">7</span>,x);axis([<span class="number">-0.5</span> <span class="number">7.5</span> <span class="number">-1.5</span> <span class="number">2.5</span>]);</span><br><span class="line"></span><br><span class="line">ylabel(<span class="string">'x(n) \rightarrow'</span>); </span><br><span class="line">title(<span class="string">'a) 8 samples'</span>); </span><br><span class="line">subplot(<span class="number">423</span>); </span><br><span class="line">stem(<span class="number">0</span>:<span class="number">1</span>:<span class="number">7</span>,w);axis((<span class="number">-0.5</span> <span class="number">7.5</span> <span class="number">-1.5</span> <span class="number">3</span>]); </span><br><span class="line">ylabel(<span class="string">'w(n) \rightarrow’);</span></span><br><span class="line"><span class="string">title('</span>b) <span class="number">8</span> samples Blackman window'); </span><br><span class="line"></span><br><span class="line">subplot(<span class="number">425</span>); </span><br><span class="line">stem(<span class="number">0</span>:<span class="number">1</span>:<span class="number">7</span>,x1);axis([<span class="number">-0.5</span> <span class="number">7.5</span> <span class="number">-1.5</span> <span class="number">6</span>]); </span><br><span class="line">ylabel(<span class="string">'x_w(n) \rightarrow’);</span></span><br><span class="line"><span class="string">title('</span>c) x(n)\cdot w(n)'); </span><br><span class="line"></span><br><span class="line">subplot(<span class="number">427</span>); </span><br><span class="line">stem(<span class="number">0</span>:<span class="number">1</span>:<span class="number">15</span>,x2);axis([<span class="number">-0.5</span> <span class="number">15.5</span> <span class="number">-1.5</span> <span class="number">6</span>]); </span><br><span class="line">xlabel(<span class="string">'n \rightarrow'</span>);ylabel(<span class="string">'x_w(n) \rightarrow'</span>); </span><br><span class="line">title(<span class="string">'d) x(n)\cdot w(n) + zero-padding'</span>);</span><br><span class="line"></span><br><span class="line">subplot(<span class="number">222</span>); </span><br><span class="line">stem(<span class="number">0</span>:<span class="number">1</span>:<span class="number">7</span>,<span class="built_in">abs</span>(fft(xi)));axis([<span class="number">-0.5</span> <span class="number">7.5</span> <span class="number">-0.5</span> <span class="number">15</span>]); </span><br><span class="line">ylabel (<span class="string">'IX(k)I \right arrow'</span>) ; </span><br><span class="line">title(<span class="string">'8-point FFT of c)'</span>); </span><br><span class="line"></span><br><span class="line">subplot(<span class="number">224</span>); </span><br><span class="line">stem(<span class="number">0</span>:<span class="number">1</span>:<span class="number">15</span>,<span class="built_in">abs</span>(fft(x2)));axis([<span class="number">-1</span> <span class="number">16</span> <span class="number">-0.5</span> <span class="number">15</span>]); </span><br><span class="line">xlabel(<span class="string">'k \rightarrow'</span>);ylabel(<span class="string">'IX(k)(\rightarrow'</span>); </span><br><span class="line">title(<span class="string">'16-point FFT of d)'</span>);</span><br></pre></td></tr></table></figure>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.10.JPG" alt="图1.10"><br><em>图1.10 通过窗函数减小频率泄露效应：(a)原始信号，(b)长度为8的Blackman窗函数，(c)产生x(n)∙w(n),0≤n≤N-1，(d)将x(n)∙w(n)通过零填充到长度为N=16，右边是对应的频谱</em> </div>

<h3 id="频谱图：时频表示"><a href="#频谱图：时频表示" class="headerlink" title="频谱图：时频表示"></a>频谱图：时频表示</h3><div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.11.JPG" alt="图1.11"><br><em>图1.11 FFT得到的短时频谱分析</em> </div>

<p>&emsp;&emsp;这张特殊的时频表示是一份给出短时，分时的信号频率内容估计的频谱图（Spectrogram）。我们可以看到信号被分成了几分长度为N，且被加窗后进行了FFT运算（图1.11）。可以将加权后的分段进行重叠（overlap），进而增加短时频谱的分时分析部分。图1.12是一副短时频谱的图像，在水平轴上时间线性地增加，在垂直轴上是频率的递增（三维图）。所以在每个垂直上的每个垂直线是频率分量幅度的绝对值|X(f)|，并通过灰度值根据频率变化显示（图1.12）。其中只有采样频率一半以下的频率才有描述。另外可以通过MATLAB的函数<code>B=SPECGRAM(x,NFFT,Fs,WINDOW,NOVERLAP)</code>计算信号的频谱图。</p>
<p>&emsp;&emsp;图1.13的瀑布图是另一种对信号x(n)的短时傅里叶变换的时频表示，该图可以通过M-file 1.8生成，利用其中的瀑布计算算法，这个算法在M-file 1.9给出。</p>
<h4 id="M-file-1-8（figure1-13-m）"><a href="#M-file-1-8（figure1-13-m）" class="headerlink" title="M-file 1.8（figure1_13.m）"></a>M-file 1.8（figure1_13.m）</h4><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[signal,FS,NBITS]=wavread(<span class="string">'ton2'</span>);</span><br><span class="line">subplot(<span class="number">211</span>);<span class="built_in">plot</span>(signal);</span><br><span class="line">subplot(<span class="number">212</span>);</span><br><span class="line">waterfspec(signal,<span class="number">256</span>,<span class="number">256</span>,<span class="number">512</span>,FS,<span class="number">20</span>,<span class="number">-100</span>);</span><br></pre></td></tr></table></figure>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.12.JPG" alt="图1.12"><br><em>图1.12 通过加权后的分段进行FFT得到的频谱图</em> </div>

<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.13.JPG" alt="图1.13"><br><em>图1.13 通过加权后的分段进行FFT得到的瀑布图</em> </div>

<h4 id="M-file-1-9（waterfspec-m）"><a href="#M-file-1-9（waterfspec-m）" class="headerlink" title="M-file 1.9（waterfspec.m）"></a>M-file 1.9（waterfspec.m）</h4><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">yy</span>=<span class="title">waterfspec</span><span class="params">(signal,start,steps,N,fS,clippingpoint,baseplane)</span></span></span><br><span class="line"><span class="comment">% waterfspec(signal, start, steps, N, fS, clippingpoint, baseplane)</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">% shows short-time spectra of signal, starting</span></span><br><span class="line"><span class="comment">% at k=start, with increments of STEP with N-point FFT </span></span><br><span class="line"><span class="comment">% dynamic range from -baseplane in dB up to 20*log(clippingpoint) </span></span><br><span class="line"><span class="comment">% in dB versus time axis </span></span><br><span class="line"><span class="comment">% </span></span><br><span class="line"><span class="comment">% 18/9/98 J. Schattschneider </span></span><br><span class="line"><span class="comment">% 14/10/2000 U. Zoelzer </span></span><br><span class="line">echo off; </span><br><span class="line"><span class="keyword">if</span> nargin&lt;<span class="number">7</span>, baseplane=<span class="number">-100</span>; <span class="keyword">end</span> </span><br><span class="line"><span class="keyword">if</span> nargin&lt;<span class="number">6</span>, clippingpoint=O; <span class="keyword">end</span> </span><br><span class="line"><span class="keyword">if</span> nargin&lt;<span class="number">5</span>, fS=<span class="number">48000</span>; <span class="keyword">end</span> </span><br><span class="line"><span class="keyword">if</span> nargin&lt;<span class="number">4</span>, N=<span class="number">1024</span>; <span class="keyword">end</span> 	<span class="comment">% default FFT </span></span><br><span class="line"><span class="keyword">if</span> nargin&lt;<span class="number">3</span>, steps=<span class="built_in">round</span>(<span class="built_in">length</span>(signal)/<span class="number">25</span>); <span class="keyword">end</span> </span><br><span class="line"><span class="keyword">if</span> nargin&lt;<span class="number">2</span>, start=<span class="number">0</span>; <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">windoo=blackman(N); 			<span class="comment">% window - default</span></span><br><span class="line">windoo=windoo*N/sum(windoo)	<span class="comment">% scaling</span></span><br><span class="line"><span class="comment">% Calculation of number of spectra nos</span></span><br><span class="line">n=<span class="built_in">length</span>(signal); </span><br><span class="line">rest=n-start-N; </span><br><span class="line">nos=<span class="built_in">round</span>(rest/steps); </span><br><span class="line"><span class="keyword">if</span> nos&gt;rest/steps, nos=nos<span class="number">-1</span>; <span class="keyword">end</span></span><br><span class="line"><span class="comment">% vectors for 3D representation</span></span><br><span class="line">x=<span class="built_in">linspace</span>(<span class="number">0</span>, fS/<span class="number">1000</span> ,N+<span class="number">1</span>); </span><br><span class="line">z=x-x; </span><br><span class="line">cup=z+clippingpoint; </span><br><span class="line">cdown=z+baseplane;</span><br><span class="line"></span><br><span class="line">signal=signal+<span class="number">0.0000001</span>; </span><br><span class="line"><span class="comment">% Computation of spectra and visual representation</span></span><br><span class="line">      <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">1</span>:nos,</span><br><span class="line">        spek1=<span class="number">20.</span>*<span class="built_in">log10</span>(<span class="built_in">abs</span>(fft(windoo.*signal(<span class="number">1</span>+start+ ....</span><br><span class="line">       .... <span class="built_in">i</span>*steps:start+N+<span class="built_in">i</span>*steps)))./(N)/<span class="number">0.5</span>);</span><br><span class="line">        spek= [<span class="number">-200</span> ; spek1(<span class="number">1</span>:N)]; </span><br><span class="line">spek=(spek&gt;cup').*cup'+(spek&lt;=cup').*spek; </span><br><span class="line">spek=(spek&lt;cdown').*cdown'+(spek&gt;=cdown').*spek;</span><br><span class="line">spek(l)=baseplane<span class="number">-10</span>; </span><br><span class="line">spek(N/<span class="number">2</span>)=baseplane<span class="number">-10</span>; </span><br><span class="line">y=x-x+(<span class="built_in">i</span><span class="number">-1</span>); </span><br><span class="line"><span class="keyword">if</span> <span class="built_in">i</span>==<span class="number">1</span>, </span><br><span class="line">p=<span class="built_in">plot3</span>(x(<span class="number">1</span>:N/<span class="number">2</span>),y(<span class="number">1</span>:N/<span class="number">2</span>),spek(<span class="number">1</span>:N/<span class="number">2</span>),<span class="string">'k'</span>); </span><br><span class="line">set(p,<span class="string">'Linewidth'</span>,<span class="number">0.1</span>); </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">  pp=patch(x(<span class="number">1</span> :N/<span class="number">2</span>) ,y(<span class="number">1</span> :N/<span class="number">2</span>), spek(<span class="number">1</span> :N/<span class="number">2</span>),<span class="string">'w'</span>,<span class="string">'Visible'</span>,<span class="string">'on'</span>); </span><br><span class="line">set (pp,<span class="string">'Linewidth'</span>, <span class="number">0.</span> <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">set (gca,<span class="string">'DrawMode'</span>,<span class="string">'fast'</span>);</span><br><span class="line">axis([<span class="number">-0.3</span> fS/<span class="number">2000</span>+<span class="number">0.3</span> <span class="number">0</span> nos baseplane<span class="number">-10</span> <span class="number">0</span>]);</span><br><span class="line">set(gca,<span class="string">'Ydir’,’reverse’);</span></span><br><span class="line"><span class="string">view(12,40);</span></span><br></pre></td></tr></table></figure>
<p></p>
<p><span id="1.2.3"></span></p>
<h2 id="1-2-3-数字系统"><a href="#1-2-3-数字系统" class="headerlink" title="1.2.3 数字系统"></a>1.2.3 数字系统</h2><p>&emsp;&emsp;数字系统通常是一个对输入信号（例如一个数值序列（流）x(n)），进行如加法、乘法和延时操作等数字运算的算法。算法得出的结果会是一个数值序列或输出信号y(n)。行为不随时间发生变化且不会因时间，属性发生累积效应的系统称为线性时不变系统（LTI：Linear time-invariant）【Orf96】。非线性时不变系统将在第五章讨论。LTI数字系统的输入与输出的关系描述了基于以下的术语与定义的时域关系：</p>
<ul>
<li>单位冲击，冲激响应和离散卷积；</li>
<li>算法与信号的流图（flow graphs）</li>
</ul>
<p>&emsp;&emsp;对于这些定于，有在频域等价的描述，等下会介绍。</p>
<h3 id="单位冲击，冲击响应和离散卷积"><a href="#单位冲击，冲击响应和离散卷积" class="headerlink" title="单位冲击，冲击响应和离散卷积"></a>单位冲击，冲击响应和离散卷积</h3><ul>
<li>测试信号：单位冲击时在数字系统中十分有用的测试信号</li>
</ul>

$$
\begin{equation}
\delta = \left\{
\begin{aligned}
1\,for\,n=0 \\
0\,for\,n \neq 0
\end{aligned}
\right.
\end{equation}
\tag{1.7}
$$

<p>&emsp;&emsp;单位冲击中，输出在n=0时等于1，其他地方都为0（图1.14）。</p>
<ul>
<li>冲击响应：如果我们把单位采样函数应用到数字系统，数字系统会得到输出信号y(n)=h(n)，h(n)是数字系统的冲击响应。图1.14可以看到数字系统抽象成了一个完全由h(n)冲击响应描述的黑匣子。</li>
</ul>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.14.JPG" alt="图1.14"><br><em>图1.14 冲击响应h(n)作为数字系统在时域的描述</em> </div>

<ul>
<li>离散卷积：如果我们已知一个数字系统的冲击响应h(n)，我们可以通过离散卷积方程从任意选择的输入信号x(n)计算输出信号y(n)。</li>
</ul>

$$
y(n) = \sum_{k=-\infty }^{\infty }x(k)\cdot h(n-k)=x(n)\ast h(n),
\tag{1.8}
$$

<p>&emsp;&emsp;通常用第二个式子y(n)=x(n)*h(n)作为它的简写。式子(1.8)中的离散求和方程表达了在时域中一个数字系统输入与输出的关系。卷积求和方程(1.8)也可以通过MATLAB方程y=conv(x,h)实现。</p>
<h3 id="算法和信号流程图"><a href="#算法和信号流程图" class="headerlink" title="算法和信号流程图"></a>算法和信号流程图</h3><p>&emsp;&emsp;上面给出的离散卷积方程展示了一项由给出输入信号x(n)计算的到输出信号y(n)的数学运算。下面我们将介绍一个称为信号流程图的图像表示方法，用图示方框图展示了输入与输出的数学关系。我们将通过三种图形表示：参数信号乘法、延时和信号求和，来讨论几个算法的例子。</p>
<ul>
<li>将输入信号延时两个采样间隔：</li>
</ul>

$$
y(n) = x(n-2)
\tag{1.9}
$$

<p>&emsp;&emsp;该式子如图1.15的信号流程图所表示。</p>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.15.JPG" alt="图1.15"><br><em>图1.15 输入信号的延时</em> </div>

<ul>
<li>根据参数a对输入信号加权：</li>
</ul>

$$
y(n) = a \cdot x(n)
\tag{1.10}
$$

<p>&emsp;&emsp;该式子如图1.16的信号流程图所表示。</p>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.16.JPG" alt="图1.16"><br><em>图1.16 给输入信号加权</em> </div>

<ul>
<li>两个信号的加法：</li>
</ul>

$$
y(n) = a_{1} \cdot x_{1}(n) + a_{2} \cdot x_{2}(n)
\tag{1.11}
$$

<p>该式子如图1.17的流程图所表示。</p>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.17.JPG" alt="图1.17"><br><em>图1.17 两个信号x<sub>1&lt;\sub&gt;(n)和x<sub>2&lt;\sub&gt;(n)的加法</sub></sub></em> </div>

<ul>
<li>以上算法的结合，对几个输入样本进行加权求和：</li>
</ul>

$$
y(n) = \frac{1}{3}x(n) + \frac{1}{3}x(n-1) + \frac{1}{3}x(n-2)
\tag{1.12}
$$

<p>该式子如图1.18的流程图所表示。</p>
<div align="center"><img src="/DAFX/DAFX-1-介绍/figure_1.18.JPG" alt="图1.18"><br><em>图1.18 简单的数字系统</em> </div>

<h3 id="传递函数与频率响应"><a href="#传递函数与频率响应" class="headerlink" title="传递函数与频率响应"></a>传递函数与频率响应</h3><p>&emsp;&emsp;到目前我们对数字系统的描述是基于输入与输出信号在时域的关系。我们注意到输入与输出信号和数字系统的冲击响应是在离散时域给出。类似地，对于之前子节给出的频谱对数字信号频域描述的方式，我们可以具有数字系统的频域描述，其由脉冲响应h(n)表示。一个数字系统在频域的行为反映了它对输入信号频谱包括的某一频率进行通过，衰减或增强的能力。频率行为通常有两个术语：传递函数H(z)和频率响应H(f)。两者都可以通过应用于冲击响应h(n)的两个数学变换来获得。</p>
<p></p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr>

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/HerveLin" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2019 Herve Lin<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments --><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->



</body>

</html>